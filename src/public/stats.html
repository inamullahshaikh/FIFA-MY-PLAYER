<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Stats Dashboard - Virtual XI</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.2/css/bootstrap.min.css"
    />
    <link
      rel="icon"
      href="assets/images/football.ico"
      type="image/x-icon"
      class="circular-favicon"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.11.1/font/bootstrap-icons.min.css"
    />
    <style>
      .overview-section {
        margin-bottom: 2rem;
      }

      .section-title {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        margin-bottom: 1rem;
        font-weight: 600;
        color: #2c3e50;
      }

      .overview-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1rem;
        margin-bottom: 2rem;
      }

      .overview-card {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border-radius: 16px;
        padding: 1.5rem;
        color: white;
        display: flex;
        align-items: center;
        gap: 1rem;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        transition: all 0.3s ease;
      }

      .overview-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 12px 48px rgba(0, 0, 0, 0.15);
      }

      .goals-card {
        background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
      }

      .assists-card {
        background: linear-gradient(135deg, #4ecdc4 0%, #44a08d 100%);
      }

      .overview-icon {
        font-size: 2rem;
        opacity: 0.9;
      }

      .overview-number {
        font-size: 2rem;
        font-weight: 700;
        line-height: 1;
      }

      .overview-label {
        font-size: 0.9rem;
        opacity: 0.9;
        margin-top: 0.25rem;
      }

      .overview-avg {
        font-size: 0.75rem;
        opacity: 0.8;
        margin-top: 0.25rem;
      }

      .yearly-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
        gap: 1.5rem;
      }

      .yearly-card {
        background: white;
        border-radius: 16px;
        padding: 1.5rem;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
        border: 1px solid #e9ecef;
        transition: all 0.3s ease;
        animation: fadeInUp 0.6s ease-out both;
      }

      .yearly-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.12);
      }

      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .yearly-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1.5rem;
      }

      .year-badge {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 0.5rem 1rem;
        border-radius: 20px;
        font-weight: 600;
        font-size: 1.1rem;
      }

      .total-contributions {
        text-align: right;
      }

      .contributions-number {
        display: block;
        font-size: 1.5rem;
        font-weight: 700;
        color: #2c3e50;
      }

      .contributions-label {
        font-size: 0.8rem;
        color: #6c757d;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .yearly-stats {
        margin-bottom: 1rem;
      }

      .stat-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1rem;
      }

      .stat-info {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        flex: 1;
      }

      .stat-icon {
        font-size: 1.2rem;
        width: 20px;
      }

      .goals-row .stat-icon {
        color: #ff6b6b;
      }

      .assists-row .stat-icon {
        color: #4ecdc4;
      }

      .stat-value {
        font-size: 1.25rem;
        font-weight: 600;
        color: #2c3e50;
      }

      .stat-label {
        font-size: 0.9rem;
        color: #6c757d;
      }

      .stat-progress {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        min-width: 80px;
      }

      .progress-bar {
        width: 60px;
        height: 6px;
        background: #e9ecef;
        border-radius: 3px;
        overflow: hidden;
      }

      .progress-fill {
        height: 100%;
        border-radius: 3px;
        transition: width 1s ease;
      }

      .goals-fill {
        background: linear-gradient(90deg, #ff6b6b, #ee5a24);
      }

      .assists-fill {
        background: linear-gradient(90deg, #4ecdc4, #44a08d);
      }

      .progress-percentage {
        font-size: 0.75rem;
        font-weight: 500;
        color: #6c757d;
        min-width: 35px;
      }

      .yearly-footer {
        border-top: 1px solid #e9ecef;
        padding-top: 1rem;
        margin-top: 1rem;
      }

      .performance-indicator {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.5rem 0.75rem;
        border-radius: 20px;
        font-size: 0.8rem;
        font-weight: 500;
        width: fit-content;
      }

      .performance-excellent {
        background: #d4edda;
        color: #155724;
      }

      .performance-good {
        background: #cce7ff;
        color: #004085;
      }

      .performance-average {
        background: #fff3cd;
        color: #856404;
      }

      .performance-below {
        background: #f8d7da;
        color: #721c24;
      }

      .empty-state {
        text-align: center;
        padding: 3rem 1rem;
        color: #6c757d;
      }

      .empty-icon {
        font-size: 3rem;
        margin-bottom: 1rem;
        opacity: 0.5;
      }

      .empty-title {
        margin-bottom: 0.5rem;
        color: #495057;
      }

      .empty-subtitle {
        margin: 0;
        font-size: 0.9rem;
      }

      #yearlyStatsContainer {
        opacity: 0;
        transition: opacity 0.3s ease;
      }

      #yearlyStatsContainer.loaded {
        opacity: 1;
      }
      :root {
        --primary: #4361ee;
        --primary-dark: #3a56d4;
        --secondary: #4cc9f0;
        --dark: #2b2d42;
        --light: #f8f9fa;
        --danger: #ef476f;
        --success: #06d6a0;
        --warning: #ffd166;
        --gray-dark: #343a40;
        --gray: #6c757d;
        --gray-light: #e9ecef;
        --transition: all 0.3s ease;
        --shadow-sm: 0 2px 4px rgba(0, 0, 0, 0.05);
        --shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.12);
        --border-radius: 0.75rem;
      }

      body {
        font-family: "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI",
          Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
        background-color: #f5f7fa;
        color: var(--dark);
        overflow-x: hidden;
        position: relative;
      }

      /* Navbar Styles */
      .navbar {
        background-color: var(--primary);
        box-shadow: var(--shadow);
        padding: 0.75rem 0;
        position: fixed;
        width: 100%;
        top: 0;
        z-index: 1030;
      }

      .navbar-brand {
        font-weight: 700;
        font-size: 1.5rem;
        letter-spacing: -0.5px;
        color: white;
        display: flex;
        align-items: center;
      }

      .navbar-brand:before {
        content: "";
        display: inline-block;
        width: 1.75rem;
        height: 1.75rem;
        margin-right: 0.75rem;
        background-color: rgba(255, 255, 255, 0.2);
        border-radius: 0.5rem;
        position: relative;
      }

      .navbar-brand:after {
        content: "";
        position: absolute;
        width: 1rem;
        height: 1rem;
        background-color: white;
        border-radius: 0.25rem;
        transform: rotate(45deg);
        margin-left: 0.375rem;
      }

      .navbar .nav-link {
        color: rgba(255, 255, 255, 0.8);
        font-weight: 500;
        padding: 0.5rem 1rem;
        transition: var(--transition);
        border-radius: var(--border-radius);
        margin: 0 0.25rem;
      }

      .navbar .nav-link:hover,
      .navbar .nav-link.active {
        color: white;
        background-color: rgba(255, 255, 255, 0.1);
      }

      .logout-btn {
        background-color: rgba(255, 255, 255, 0.15);
        color: white !important;
        border-radius: var(--border-radius);
        margin-left: 0.75rem;
        padding: 0.5rem 1.25rem !important;
        cursor: pointer;
        transition: var(--transition);
        font-weight: 600;
      }

      .logout-btn:hover {
        background-color: rgba(255, 255, 255, 0.25);
      }

      /* Sidebar Styles */
      .sidebar {
        position: fixed;
        top: 0;
        left: 0;
        height: 100vh;
        width: 280px;
        background: white;
        box-shadow: var(--shadow);
        padding-top: 4.5rem;
        z-index: 1020;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        transition: transform 0.3s ease;
      }

      .sidebar h4 {
        font-size: 1.1rem;
        font-weight: 600;
        color: var(--gray);
        margin: 0.75rem 1.5rem;
        padding-bottom: 0.75rem;
        border-bottom: 1px solid var(--gray-light);
      }

      .sidebar a {
        display: flex;
        align-items: center;
        padding: 0.875rem 1.5rem;
        color: var(--dark);
        text-decoration: none;
        font-weight: 500;
        transition: var(--transition);
        margin: 0.25rem 0.75rem;
        border-radius: var(--border-radius);
        cursor: pointer;
      }

      .sidebar a:hover,
      .sidebar a.active {
        background-color: rgba(67, 97, 238, 0.1);
        color: var(--primary);
      }

      .sidebar a i {
        margin-right: 0.75rem;
        font-size: 1.25rem;
        color: var(--gray);
        transition: var(--transition);
        width: 2rem;
        text-align: center;
      }

      .sidebar a:hover i,
      .sidebar a.active i {
        color: var(--primary);
      }

      .sidebar-footer {
        padding: 1.5rem;
        border-top: 1px solid var(--gray-light);
      }

      .sidebar-footer .logout-btn {
        display: flex;
        align-items: center;
        justify-content: center;
        background-color: var(--gray-light);
        color: var(--gray-dark) !important;
        width: 100%;
        padding: 0.75rem !important;
        font-weight: 600;
      }

      .sidebar-footer .logout-btn:hover {
        background-color: var(--danger);
        color: white !important;
      }

      .sidebar-footer .logout-btn i {
        color: inherit;
      }

      /* Sidebar Toggle Button */
      .sidebar-toggle {
        position: fixed;
        bottom: 2rem;
        right: 2rem;
        width: 3.5rem;
        height: 3.5rem;
        background-color: var(--primary);
        color: white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: var(--shadow-lg);
        cursor: pointer;
        z-index: 1040;
        transition: var(--transition);
      }

      .sidebar-toggle:hover {
        background-color: var(--primary-dark);
        transform: scale(1.05);
      }

      .sidebar-toggle i {
        font-size: 1.5rem;
      }

      /* Main Content */
      .main-content {
        margin-left: 280px;
        padding: 6rem 2rem 2rem;
        min-height: 100vh;
      }

      .section-header {
        margin-bottom: 2rem;
        padding-bottom: 1rem;
        border-bottom: 2px solid var(--gray-light);
      }

      .section-header h2 {
        color: var(--primary);
        font-weight: 700;
        margin-bottom: 0.5rem;
      }

      .section-header p {
        color: var(--gray);
        margin: 0;
      }

      /* Card Styles */
      .stat-card {
        background: white;
        border-radius: var(--border-radius);
        box-shadow: var(--shadow);
        padding: 1.5rem;
        margin-bottom: 1.5rem;
        transition: var(--transition);
        border: 1px solid rgba(0, 0, 0, 0.05);
      }

      .stat-card:hover {
        box-shadow: var(--shadow-lg);
        transform: translateY(-2px);
      }

      .stat-card h5 {
        color: var(--primary);
        font-weight: 600;
        margin-bottom: 1rem;
        display: flex;
        align-items: center;
      }

      .stat-card h5 i {
        margin-right: 0.5rem;
        color: var(--secondary);
      }

      .stat-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1rem;
      }

      .stat-item {
        text-align: center;
        padding: 1rem;
        background: var(--light);
        border-radius: calc(var(--border-radius) - 0.25rem);
      }

      .stat-number {
        font-size: 2rem;
        font-weight: 700;
        color: var(--primary);
        display: block;
      }

      .stat-label {
        color: var(--gray);
        font-size: 0.875rem;
        font-weight: 500;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .highlight-card {
        background: linear-gradient(135deg, var(--primary), var(--secondary));
        color: white;
      }

      .highlight-card .stat-item {
        background: rgba(255, 255, 255, 0.1);
        color: white;
      }

      .highlight-card .stat-number {
        color: white;
      }

      .highlight-card .stat-label {
        color: rgba(255, 255, 255, 0.8);
      }

      .season-card {
        border-left: 4px solid var(--primary);
      }

      .competition-card {
        border-left: 4px solid var(--success);
      }

      .team-card {
        border-left: 4px solid var(--warning);
      }

      /* Horizontal Season Card Styles */
      .horizontal-season-card {
        background: white;
        border-radius: var(--border-radius);
        box-shadow: var(--shadow);
        margin-bottom: 1.5rem;
        transition: var(--transition);
        border: 1px solid rgba(0, 0, 0, 0.05);
        border-left: 4px solid var(--primary);
        overflow: hidden;
      }

      .horizontal-season-card:hover {
        box-shadow: var(--shadow-lg);
        transform: translateY(-2px);
      }

      .season-header {
        background: linear-gradient(135deg, var(--primary), var(--secondary));
        color: white;
        padding: 1.25rem 1.5rem;
        display: flex;
        align-items: center;
        justify-content: space-between;
      }

      .season-header h5 {
        margin: 0;
        font-weight: 700;
        font-size: 1.25rem;
        display: flex;
        align-items: center;
      }

      .season-header h5 i {
        margin-right: 0.75rem;
        font-size: 1.5rem;
      }

      .season-totals {
        display: flex;
        gap: 2rem;
        align-items: center;
      }

      .season-total-item {
        text-align: center;
      }

      .season-total-number {
        font-size: 1.5rem;
        font-weight: 700;
        display: block;
        margin-bottom: 0.25rem;
      }

      .season-total-label {
        font-size: 0.75rem;
        opacity: 0.9;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .season-body {
        padding: 1.5rem;
      }

      .competition-breakdown {
        display: grid;
        gap: 1rem;
      }

      .competition-item {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 1rem;
        background: var(--light);
        border-radius: calc(var(--border-radius) - 0.25rem);
        transition: var(--transition);
      }

      .competition-item:hover {
        background: rgba(67, 97, 238, 0.05);
        transform: translateX(5px);
      }

      .competition-info {
        display: flex;
        flex-direction: column;
      }

      .competition-name {
        font-weight: 600;
        color: var(--dark);
        margin-bottom: 0.25rem;
      }

      .team-name {
        font-size: 0.875rem;
        color: var(--gray);
      }

      .competition-stats {
        display: flex;
        gap: 0.75rem;
        align-items: center;
      }

      .stat-badge {
        padding: 0.25rem 0.75rem;
        border-radius: 1rem;
        font-size: 0.75rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .stat-badge.apps {
        background-color: var(--primary);
        color: white;
      }

      .stat-badge.goals {
        background-color: var(--success);
        color: white;
      }

      .stat-badge.assists {
        background-color: var(--secondary);
        color: white;
      }

      .stat-badge.ga {
        background-color: var(--warning);
        color: var(--dark);
      }

      .stat-badge.rating {
        background-color: var(--gray);
        color: white;
      }

      /* Responsive */
      @media (max-width: 768px) {
        .sidebar {
          transform: translateX(-100%);
        }

        .sidebar.show {
          transform: translateX(0);
        }

        .main-content {
          margin-left: 0;
          padding: 6rem 1rem 2rem;
        }

        .stat-grid {
          grid-template-columns: repeat(2, 1fr);
        }

        .season-header {
          flex-direction: column;
          align-items: flex-start;
          gap: 1rem;
        }

        .season-totals {
          gap: 1rem;
        }

        .competition-item {
          flex-direction: column;
          align-items: flex-start;
          gap: 1rem;
        }

        .competition-stats {
          flex-wrap: wrap;
        }
      }

      .loading {
        text-align: center;
        padding: 2rem;
        color: var(--gray);
      }

      .error {
        background-color: #fff5f5;
        border: 1px solid #fed7d7;
        color: #c53030;
        padding: 1rem;
        border-radius: var(--border-radius);
        margin: 1rem 0;
      }
      /* Enhanced Tab Navigation Styling */
      .nav-tabs {
        border-bottom: 2px solid #e9ecef;
        padding: 0 1rem;
        background: linear-gradient(135deg, #f8f9fa, #ffffff);
        border-radius: 0.5rem 0.5rem 0 0;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        overflow-x: auto;
        overflow-y: hidden;
        white-space: nowrap;
      }

      .nav-tabs .nav-item {
        margin-bottom: -2px;
        display: inline-block;
      }

      .nav-tabs .nav-link {
        border: none;
        border-radius: 0.5rem 0.5rem 0 0;
        padding: 1rem 1.5rem;
        margin-right: 0.2rem;
        font-weight: 500;
        color: #6c757d;
        background: transparent;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        position: relative;
        overflow: hidden;
        text-transform: capitalize;
        letter-spacing: 0.5px;
        min-width: max-content;
      }

      .nav-tabs .nav-link::before {
        content: "";
        position: absolute;
        bottom: 0;
        left: 50%;
        width: 0;
        height: 3px;
        background: linear-gradient(90deg, #007bff, #0056b3);
        transition: all 0.3s ease;
        transform: translateX(-50%);
      }

      .nav-tabs .nav-link::after {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(0, 123, 255, 0.1),
          transparent
        );
        transition: left 0.6s ease;
      }

      .nav-tabs .nav-link:hover {
        color: #007bff;
        background: rgba(0, 123, 255, 0.05);
        transform: translateY(-2px);
        box-shadow: 0 4px 15px rgba(0, 123, 255, 0.1);
      }

      .nav-tabs .nav-link:hover::before {
        width: 80%;
      }

      .nav-tabs .nav-link:hover::after {
        left: 100%;
      }

      /* Active tab styling */
      .nav-tabs .nav-link.active {
        color: #007bff;
        background: linear-gradient(135deg, #ffffff, #f8f9fa);
        border-bottom: 3px solid #007bff;
        box-shadow: 0 -2px 10px rgba(0, 123, 255, 0.15);
        transform: translateY(-1px);
        font-weight: 600;
      }

      .nav-tabs .nav-link.active::before {
        width: 100%;
        height: 3px;
        background: linear-gradient(90deg, #007bff, #0056b3);
      }

      /* Focus states for accessibility */
      .nav-tabs .nav-link:focus {
        outline: none;
        box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.2);
      }

      /* Add subtle pulse animation for active tab */
      @keyframes pulse {
        0% {
          box-shadow: 0 -2px 10px rgba(0, 123, 255, 0.15);
        }
        50% {
          box-shadow: 0 -2px 15px rgba(0, 123, 255, 0.25);
        }
        100% {
          box-shadow: 0 -2px 10px rgba(0, 123, 255, 0.15);
        }
      }

      .nav-tabs .nav-link.active {
        animation: pulse 2s infinite;
      }

      /* Responsive design */
      @media (max-width: 768px) {
        .nav-tabs {
          padding: 0 0.5rem;
          border-radius: 0;
        }

        .nav-tabs .nav-link {
          padding: 0.75rem 1rem;
          font-size: 0.9rem;
          margin-right: 0.125rem;
        }
      }

      @media (max-width: 576px) {
        .nav-tabs {
          padding: 0 0.25rem;
        }

        .nav-tabs .nav-link {
          padding: 0.6rem 0.8rem;
          font-size: 0.85rem;
          margin-right: 0.1rem;
        }
      }

      /* Smooth scrolling for horizontal overflow */
      .nav-tabs::-webkit-scrollbar {
        height: 4px;
      }

      .nav-tabs::-webkit-scrollbar-track {
        background: #f1f1f1;
        border-radius: 2px;
      }

      .nav-tabs::-webkit-scrollbar-thumb {
        background: #007bff;
        border-radius: 2px;
      }

      .nav-tabs::-webkit-scrollbar-thumb:hover {
        background: #0056b3;
      }

      /* Loading animation for tabs */
      @keyframes slideInUp {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .nav-tabs .nav-item {
        animation: slideInUp 0.4s ease forwards;
      }

      .nav-tabs .nav-item:nth-child(1) {
        animation-delay: 0.1s;
      }
      .nav-tabs .nav-item:nth-child(2) {
        animation-delay: 0.2s;
      }
      .nav-tabs .nav-item:nth-child(3) {
        animation-delay: 0.3s;
      }
      .nav-tabs .nav-item:nth-child(4) {
        animation-delay: 0.4s;
      }
      .nav-tabs .nav-item:nth-child(5) {
        animation-delay: 0.5s;
      }
      .nav-tabs .nav-item:nth-child(6) {
        animation-delay: 0.6s;
      }
      .nav-tabs .nav-item:nth-child(7) {
        animation-delay: 0.7s;
      }
      .nav-tabs .nav-item:nth-child(8) {
        animation-delay: 0.8s;
      }
    </style>
  </head>
  <body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark">
      <div class="container">
        <a id="wow" class="navbar-brand" href="#">Virtual XI</a>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNav"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav ms-auto">
            <li class="nav-item">
              <a class="nav-link" href="#">
                <i class="bi bi-house me-1"></i>Dashboard
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="seasondata.html">
                <i class="bi bi-bar-chart-steps me-1"></i>Season Data
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="yearlydata.html">
                <i class="bi bi-bar-chart me-1"></i>Yearly Data
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link active" href="#">
                <i class="bi bi-graph-up-arrow me-1"></i>Stats
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="trophies.html">
                <i class="bi bi-trophy me-1"></i>Trophy Cabinet
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="awards.html">
                <i class="bi bi-award me-1"></i>Awards
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link logout-btn" href="index.html">
                <i class="bi bi-box-arrow-right me-1"></i>Logout
              </a>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
      <div>
        <h4>Player Dashboard</h4>
        <a href="dashboard.html"> <i class="bi bi-house"></i> Dashboard </a>
        <a href="seasondata.html">
          <i class="bi bi-bar-chart-steps"></i> Season Data
        </a>
        <a href="yearlydata.html">
          <i class="bi bi-bar-chart"></i> Yearly Data
        </a>
        <a href="#" class="active">
          <i class="bi bi-graph-up-arrow"></i> Stats
        </a>
        <a href="trophies.html">
          <i class="bi bi-trophy"></i> Trophy Cabinet
        </a>
        <a href="awards.html"> <i class="bi bi-award"></i> Awards </a>
      </div>
      <div class="sidebar-footer">
        <a class="logout-btn" href="index.html">
          <i class="bi bi-box-arrow-right"></i> Logout
        </a>
      </div>
    </div>

    <!-- Main Content -->
    <!-- Main Content with Tabs -->
    <div class="main-content">
      <!-- Tabs Navigation -->
      <ul class="nav nav-tabs" id="statsTabs" role="tablist">
        <li class="nav-item">
          <button
            class="nav-link active"
            id="career-tab"
            data-bs-toggle="tab"
            data-bs-target="#career"
            type="button"
            role="tab"
          >
            Career
          </button>
        </li>
        <li class="nav-item">
          <button
            class="nav-link"
            id="club-tab"
            data-bs-toggle="tab"
            data-bs-target="#club"
            type="button"
            role="tab"
          >
            Club
          </button>
        </li>
        <li class="nav-item">
          <button
            class="nav-link"
            id="international-tab"
            data-bs-toggle="tab"
            data-bs-target="#international"
            type="button"
            role="tab"
          >
            International
          </button>
        </li>
        <li class="nav-item">
          <button
            class="nav-link"
            id="yearly-tab"
            data-bs-toggle="tab"
            data-bs-target="#yearly"
            type="button"
            role="tab"
          >
            Yearly
          </button>
        </li>
        <li class="nav-item">
          <button
            class="nav-link"
            id="best-tab"
            data-bs-toggle="tab"
            data-bs-target="#best"
            type="button"
            role="tab"
          >
            Best
          </button>
        </li>
        <li class="nav-item">
          <button
            class="nav-link"
            id="season-tab"
            data-bs-toggle="tab"
            data-bs-target="#season"
            type="button"
            role="tab"
          >
            Seasons
          </button>
        </li>
        <li class="nav-item">
          <button
            class="nav-link"
            id="competition-tab"
            data-bs-toggle="tab"
            data-bs-target="#competition"
            type="button"
            role="tab"
          >
            Competitions
          </button>
        </li>
        <li class="nav-item">
          <button
            class="nav-link"
            id="team-tab"
            data-bs-toggle="tab"
            data-bs-target="#team"
            type="button"
            role="tab"
          >
            Teams
          </button>
        </li>
      </ul>

      <!-- Tabs Content -->
      <div class="tab-content pt-4" id="statsTabContent">
        <!-- Career -->
        <div class="tab-pane fade show active" id="career" role="tabpanel">
          <div class="section-header">
            <h2>
              <i class="bi bi-bar-chart-fill me-2"></i>Career Statistics
              Overview
            </h2>
            <p>Complete statistical summary of your football career</p>
          </div>
          <div class="stat-card highlight-card">
            <h5 style="color: white">
              <i class="bi bi-trophy-fill" style="color: white"></i>Career
              Totals
            </h5>
            <div class="stat-grid" id="careerTotals">
              <div class="loading">Loading career statistics...</div>
            </div>
          </div>
        </div>

        <!-- Club -->
        <div class="tab-pane fade" id="club" role="tabpanel">
          <div class="section-header">
            <h2><i class="bi bi-building me-2"></i>Club Career Statistics</h2>
            <p>Your performance statistics across all club competitions</p>
          </div>
          <div class="stat-card">
            <h5><i class="bi bi-building-fill"></i>Club Career Summary</h5>
            <div class="stat-grid" id="clubStats">
              <div class="loading">Loading club statistics...</div>
            </div>
          </div>
        </div>

        <!-- International -->
        <div class="tab-pane fade" id="international" role="tabpanel">
          <div class="section-header">
            <h2>
              <i class="bi bi-flag me-2"></i>International Career Statistics
            </h2>
            <p>Your performance statistics for your national team</p>
          </div>
          <div class="stat-card">
            <h5><i class="bi bi-flag-fill"></i>International Career Summary</h5>
            <div class="stat-grid" id="intStats">
              <div class="loading">Loading international statistics...</div>
            </div>
          </div>
        </div>

        <!-- Yearly -->
        <div class="tab-pane fade" id="yearly" role="tabpanel">
          <div class="section-header">
            <h2><i class="bi bi-calendar me-2"></i>Statistics by Year</h2>
            <p>Annual breakdown of goals and assists</p>
          </div>
          <div id="yearlyStatsContainer">
            <div class="loading">Loading yearly statistics...</div>
          </div>
        </div>

        <!-- Best -->
        <div class="tab-pane fade" id="best" role="tabpanel">
          <div class="section-header">
            <h2><i class="bi bi-star me-2"></i>Best Performances</h2>
            <p>Your standout seasons and years</p>
          </div>
          <div class="row" id="bestPerformances">
            <div class="loading">Loading best performances...</div>
          </div>
        </div>

        <!-- Seasons -->
        <div class="tab-pane fade" id="season" role="tabpanel">
          <div class="section-header">
            <h2>
              <i class="bi bi-calendar-week me-2"></i>Detailed Season Statistics
            </h2>
            <p>Complete breakdown of each season's performance</p>
          </div>
          <div id="seasonDetailsContainer">
            <div class="loading">Loading detailed season statistics...</div>
          </div>
        </div>

        <!-- Competitions -->
        <div class="tab-pane fade" id="competition" role="tabpanel">
          <div class="section-header">
            <h2><i class="bi bi-trophy me-2"></i>Statistics by Competition</h2>
            <p>Performance breakdown across different competitions</p>
          </div>
          <div id="competitionStatsContainer">
            <div class="loading">Loading competition statistics...</div>
          </div>
        </div>

        <!-- Teams -->
        <div class="tab-pane fade" id="team" role="tabpanel">
          <div class="section-header">
            <h2><i class="bi bi-people me-2"></i>Statistics by Team</h2>
            <p>Performance breakdown across different teams</p>
          </div>
          <div id="teamStatsContainer">
            <div class="loading">Loading team statistics...</div>
          </div>
        </div>
      </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.2/js/bootstrap.bundle.min.js"></script>
    <script>
      const API_BASE = "http://localhost:5000/api";
      const competitions = {
        premierleague: [
          { name: "Premier League", id: "pl" },
          { name: "FA Cup", id: "fa" },
          { name: "EFL Cup", id: "efl" },
          { name: "UEFA Champions League", id: "ucl" },
          { name: "UEFA Europa League", id: "uel" },
          { name: "UEFA Conference League", id: "uecl" },
          { name: "Community Shield", id: "cs" },
          { name: "UEFA Super Cup", id: "uesc" },
        ],
        laliga: [
          { name: "La Liga", id: "ll" },
          { name: "Copa del Rey", id: "cdr" },
          { name: "Supercopa de EspaÃ±a", id: "sde" },
          { name: "UEFA Champions League", id: "ucl" },
          { name: "UEFA Europa League", id: "uel" },
          { name: "UEFA Conference League", id: "uecl" },
          { name: "UEFA Super Cup", id: "uesc" },
        ],
        seriea: [
          { name: "Serie A", id: "sa" },
          { name: "Coppa Italia", id: "ci" },
          { name: "Supercoppa Italiana", id: "si" },
          { name: "UEFA Champions League", id: "ucl" },
          { name: "UEFA Europa League", id: "uel" },
          { name: "UEFA Conference League", id: "uecl" },
          { name: "UEFA Super Cup", id: "uesc" },
        ],
        bundesliga: [
          { name: "Bundesliga", id: "bl" },
          { name: "DFB-Pokal", id: "dfb" },
          { name: "DFL-Supercup", id: "dfl" },
          { name: "UEFA Champions League", id: "ucl" },
          { name: "UEFA Europa League", id: "uel" },
          { name: "UEFA Conference League", id: "uecl" },
          { name: "UEFA Super Cup", id: "uesc" },
        ],
        ligue1: [
          { name: "Ligue 1", id: "l1" },
          { name: "Coupe de France", id: "cdf" },
          { name: "TrophÃ©e des Champions", id: "tdc" },
          { name: "UEFA Champions League", id: "ucl" },
          { name: "UEFA Europa League", id: "uel" },
          { name: "UEFA Conference League", id: "uecl" },
          { name: "UEFA Super Cup", id: "uesc" },
        ],
        international: [
          { name: "UEFA EURO", id: "euro" },
          { name: "International Friendlies", id: "friendly" },
          { name: "FIFA World Cup Qualifiers", id: "wcq" },
          { name: "FIFA World Cup", id: "wc" },
          { name: "UEFA EURO Qualifiers", id: "euq" },
        ],
      };
      const teamNameMap = {
        // Premier League
        "manchester-city": "Manchester City",
        arsenal: "Arsenal FC",
        liverpool: "Liverpool FC",
        "manchester-united": "Manchester United",
        chelsea: "Chelsea FC",
        tottenham: "Tottenham Hotspur",

        // La Liga
        "real-madrid": "Real Madrid",
        barcelona: "FC Barcelona",
        "atletico-madrid": "AtlÃ©tico de Madrid",
        sevilla: "Sevilla FC",
        "athletic-bilbao": "Athletic Bilbao",
        villarreal: "Villarreal CF",

        // Serie A
        juventus: "Juventus FC",
        "ac-milan": "AC Milan",
        "inter-milan": "Inter Milan",
        napoli: "SSC Napoli",
        roma: "AS Roma",
        lazio: "SS Lazio",

        // Bundesliga
        "bayern-munich": "Bayern Munich",
        "borussia-dortmund": "Borussia Dortmund",
        "rb-leipzig": "RB Leipzig",
        "bayer-leverkusen": "Bayer 04 Leverkusen",
        wolfsburg: "VfL Wolfsburg",
        "eintracht-frankfurt": "Eintracht Frankfurt",

        // Ligue 1
        psg: "Paris Saint-Germain",
        marseille: "Olympique Marseille",
        monaco: "AS Monaco",
        lyon: "Olympique Lyon",
        nice: "OGC Nice",
        lille: "LOSC Lille",
      };
      const teamImageMap = {
        "paris-saint-germain": "assets/images/teams/Paris Saint-Germain.png",
        "rb-leipzig": "assets/images/teams/RB Leipzig.png",
        "real-madrid": "assets/images/teams/Real Madrid.png",
        sevilla: "assets/images/teams/Sevilla FC.png",
        "ss-lazio": "assets/images/teams/SS Lazio.png",
        "ssc-napoli": "assets/images/teams/SSC Napoli.png",
        "tottenham-hotspur": "assets/images/teams/Tottenham Hotspur.png",
        valencia: "assets/images/teams/Valencia CF.png",
        "vfl-wolfsburg": "assets/images/teams/VfL Wolfsburg.png",
        villarreal: "assets/images/teams/Villarreal CF.png",
        "ac-milan": "assets/images/teams/AC Milan.png",
        arsenal: "assets/images/teams/Arsenal FC.png",
        "as-monaco": "assets/images/teams/AS Monaco.png",
        "as-roma": "assets/images/teams/AS Roma.png",
        "aston-villa": "assets/images/teams/Aston Villa.png",
        "athletic-bilbao": "assets/images/teams/Athletic Bilbao.png",
        "atletico-madrid": "assets/images/teams/AtlÃ©tico de Madrid.png",
        "bayer-leverkusen": "assets/images/teams/Bayer 04 Leverkusen.png",
        "bayern-munich": "assets/images/teams/Bayern Munich.png",
        "borussia-dortmund": "assets/images/teams/Borussia Dortmund.png",
        "borussia-monchengladbach":
          "assets/images/teams/Borussia MÃ¶nchengladbach.png",
        chelsea: "assets/images/teams/Chelsea FC.png",
        "eintracht-frankfurt": "assets/images/teams/Eintracht Frankfurt.png",
        barcelona: "assets/images/teams/FC Barcelona.png",
        "inter-milan": "assets/images/teams/Inter Milan.png",
        juventus: "assets/images/teams/Juventus FC.png",
        liverpool: "assets/images/teams/Liverpool FC.png",
        lille: "assets/images/teams/LOSC Lille.png",
        "manchester-city": "assets/images/teams/Manchester City.png",
        "manchester-united": "assets/images/teams/Manchester United.png",
        "newcastle-united": "assets/images/teams/Newcastle United.png",
        "ogc-nice": "assets/images/teams/OGC Nice.png",
        "olympique-lyon": "assets/images/teams/Olympique Lyon.png",
        "olympique-marseille": "assets/images/teams/Olympique Marseille.png",
      };
      const trophyImageMap = {
        // Club competitions
        pl: "assets/images/logos/premier-league.png",
        fa: "assets/images/logos/fa-cup.png",
        efl: "assets/images/logos/carabao-cup.png",
        ucl: "assets/images/logos/champions-league.png",
        uel: "assets/images/logos/uefa-europa-league.png", // ensure this file exists
        uecl: "assets/images/logos/uefa-conference-league.png", // ensure this file exists
        cs: "assets/images/logos/community-shield.png",
        uesc: "assets/images/logos/uefa-super-cup.png",

        ll: "assets/images/logos/la-liga.png",
        cdr: "assets/images/logos/copa-del-rey.png",
        sde: "assets/images/logos/super-copa-de-espana.png",

        sa: "assets/images/logos/serie-a.png",
        ci: "assets/images/logos/coppa-italia.png", // you may need to add this file
        si: "assets/images/logos/supercoppa-italiana.png", // you may need to add this file

        bl: "assets/images/logos/bundesliga.png",
        dfb: "assets/images/logos/dfb-pokal.png", // you may need to add this file
        dfl: "assets/images/logos/dfl-supercup.png", // you may need to add this file

        l1: "assets/images/logos/ligue-1.png",
        cdf: "assets/images/logos/coupe-de-france.png", // you may need to add this file
        tdc: "assets/images/logos/trophee-des-champions.png", // you may need to add this file

        // ðŸŒ International competitions
        euro: "assets/images/logos/euro.png",
        euq: "assets/images/logos/euro-qual.png",
        wc: "assets/images/logos/world-cup.png",
        wcq: "assets/images/logos/world-cup-qual.png",
        friendly: "assets/images/logos/international-friendlies.png",
      };

      function getCompetitionNameById(compId) {
        for (const category in competitions) {
          const match = competitions[category].find(
            (comp) => comp.id === compId
          );
          if (match) return match.name;
        }
        return compId; // fallback if not found
      }
      function getCompetitionIdByName(compName) {
        for (const category in competitions) {
          const match = competitions[category].find(
            (comp) => comp.name === compName
          );
          if (match) return match.id;
        }
        return compName; // fallback if not found
      }

      // Toggle sidebar for mobile
      function toggleSidebar() {
        document.getElementById("sidebar").classList.toggle("show");
      }

      // Utility functions
      function showError(containerId, message) {
        document.getElementById(containerId).innerHTML = `
              <div class="error">
                <i class="bi bi-exclamation-triangle me-2"></i>
                ${message}
              </div>
            `;
      }

      function formatNumber(num) {
        return num.toLocaleString();
      }

      function calculateAverage(values) {
        return values.length > 0
          ? (values.reduce((a, b) => a + b, 0) / values.length).toFixed(2)
          : 0;
      }

      // Fetch data from API
      async function fetchData(endpoint) {
        try {
          const response = await fetch(`${API_BASE}/${endpoint}`);
          if (!response.ok)
            throw new Error(`HTTP error! status: ${response.status}`);
          return await response.json();
        } catch (error) {
          console.error(`Error fetching ${endpoint}:`, error);
          throw error;
        }
      }

      // Load career totals
      async function loadCareerTotals() {
        try {
          const [seasonData, intData, yearlyData] = await Promise.all([
            fetchData("season_data"),
            fetchData("int_data"),
            fetchData("yearly_data"),
          ]);

          const totalApps =
            seasonData.reduce((sum, item) => sum + item.apps, 0) +
            intData.reduce((sum, item) => sum + item.apps, 0);
          const totalGoals =
            seasonData.reduce((sum, item) => sum + item.goals, 0) +
            intData.reduce((sum, item) => sum + item.goals, 0);
          const totalAssists =
            seasonData.reduce((sum, item) => sum + item.assists, 0) +
            intData.reduce((sum, item) => sum + item.assists, 0);

          const allRatings = [...seasonData, ...intData]
            .map((item) => item.avgrating)
            .filter((rating) => rating > 0);
          const avgRating = calculateAverage(allRatings);

          document.getElementById("careerTotals").innerHTML = `
                <div class="stat-item">
                  <span class="stat-number">${formatNumber(totalApps)}</span>
                  <span class="stat-label">Total Appearances</span>
                </div>
                <div class="stat-item">
                  <span class="stat-number">${formatNumber(totalGoals)}</span>
                  <span class="stat-label">Total Goals</span>
                </div>
                <div class="stat-item">
                  <span class="stat-number">${formatNumber(totalAssists)}</span>
                  <span class="stat-label">Total Assists</span>
                </div>
                <div class="stat-item">
                  <span class="stat-number">${avgRating}</span>
                  <span class="stat-label">Average Rating</span>
                </div>
                <div class="stat-item">
                  <span class="stat-number">${formatNumber(
                    totalGoals + totalAssists
                  )}</span>
                  <span class="stat-label">Total G/A</span>
                </div>
                <div class="stat-item">
                  <span class="stat-number">${
                    totalApps > 0 ? (totalGoals / totalApps).toFixed(2) : "0.00"
                  }</span>
                  <span class="stat-label">Goals per Game</span>
                </div>
              `;
        } catch (error) {
          showError("careerTotals", "Failed to load career statistics");
        }
      }

      // Load club stats
      async function loadClubStats() {
        try {
          const seasonData = await fetchData("season_data");

          const totalApps = seasonData.reduce(
            (sum, item) => sum + item.apps,
            0
          );
          const totalGoals = seasonData.reduce(
            (sum, item) => sum + item.goals,
            0
          );
          const totalAssists = seasonData.reduce(
            (sum, item) => sum + item.assists,
            0
          );

          const clubRatings = seasonData
            .map((item) => item.avgrating)
            .filter((rating) => rating > 0);
          const avgRating = calculateAverage(clubRatings);
          document.getElementById("clubStats").innerHTML = `
                <div class="stat-item">
                  <span class="stat-number">${formatNumber(totalApps)}</span>
                  <span class="stat-label">Club Appearances</span>
                </div>
                <div class="stat-item">
                  <span class="stat-number">${formatNumber(totalGoals)}</span>
                  <span class="stat-label">Club Goals</span>
                </div>
                <div class="stat-item">
                  <span class="stat-number">${formatNumber(totalAssists)}</span>
                  <span class="stat-label">Club Assists</span>
                </div>
                <div class="stat-item">
                  <span class="stat-number">${avgRating}</span>
                  <span class="stat-label">Average Rating</span>
                </div>
                <div class="stat-item">
                  <span class="stat-number">${formatNumber(
                    totalGoals + totalAssists
                  )}</span>
                  <span class="stat-label">Club G/A</span>
                </div>
                <div class="stat-item">
                  <span class="stat-number">${
                    totalApps > 0 ? (totalGoals / totalApps).toFixed(2) : "0.00"
                  }</span>
                  <span class="stat-label">Goals per Game</span>
                </div>
              `;
        } catch (error) {
          showError("clubStats", "Failed to load club statistics");
        }
      }

      // Load international stats
      async function loadIntStats() {
        try {
          const intData = await fetchData("int_data");

          const totalApps = intData.reduce((sum, item) => sum + item.apps, 0);
          const totalGoals = intData.reduce((sum, item) => sum + item.goals, 0);
          const totalAssists = intData.reduce(
            (sum, item) => sum + item.assists,
            0
          );

          const intRatings = intData
            .map((item) => item.avgrating)
            .filter((rating) => rating > 0);
          const avgRating = calculateAverage(intRatings);

          document.getElementById("intStats").innerHTML = `
                <div class="stat-item">
                  <span class="stat-number">${formatNumber(totalApps)}</span>
                  <span class="stat-label">International Caps</span>
                </div>
                <div class="stat-item">
                  <span class="stat-number">${formatNumber(totalGoals)}</span>
                  <span class="stat-label">International Goals</span>
                </div>
                <div class="stat-item">
                  <span class="stat-number">${formatNumber(totalAssists)}</span>
                  <span class="stat-label">International Assists</span>
                </div>
                <div class="stat-item">
                  <span class="stat-number">${avgRating}</span>
                  <span class="stat-label">Average Rating</span>
                </div>
                <div class="stat-item">
                  <span class="stat-number">${formatNumber(
                    totalGoals + totalAssists
                  )}</span>
                  <span class="stat-label">International G/A</span>
                </div>
                <div class="stat-item">
                  <span class="stat-number">${
                    totalApps > 0 ? (totalGoals / totalApps).toFixed(2) : "0.00"
                  }</span>
                  <span class="stat-label">Goals per Game</span>
                </div>
              `;
        } catch (error) {
          showError("intStats", "Failed to load international statistics");
        }
      }

      // Load yearly stats
      async function loadYearlyStats() {
        try {
          const yearlyData = await fetchData("yearly_data");
          const container = document.getElementById("yearlyStatsContainer");

          if (!yearlyData || yearlyData.length === 0) {
            container.innerHTML = `
        <div class="empty-state">
          <div class="empty-icon">
            <i class="bi bi-graph-up-arrow"></i>
          </div>
          <h6 class="empty-title">No Data Available</h6>
          <p class="empty-subtitle">Yearly statistics will appear here once data is loaded</p>
        </div>
      `;
            return;
          }

          // Calculate totals for overview
          const totalGoals = yearlyData.reduce(
            (sum, year) => sum + year.goals,
            0
          );
          const totalAssists = yearlyData.reduce(
            (sum, year) => sum + year.assists,
            0
          );
          const avgGoals = (totalGoals / yearlyData.length).toFixed(1);
          const avgAssists = (totalAssists / yearlyData.length).toFixed(1);

          let html = `
      <!-- Overview Cards -->
      <div class="overview-section">
        <h4 class="section-title">
          <i class="bi bi-trophy-fill text-warning"></i>
          Career Overview
        </h4>
        <div class="overview-grid">
          <div class="overview-card goals-card">
            <div class="overview-icon">
              <i class="bi bi-bullseye"></i>
            </div>
            <div class="overview-content">
              <div class="overview-number">${formatNumber(totalGoals)}</div>
              <div class="overview-label">Total Goals</div>
              <div class="overview-avg">Avg: ${avgGoals}/year</div>
            </div>
          </div>
          <div class="overview-card assists-card">
            <div class="overview-icon">
              <i class="bi bi-hand-thumbs-up-fill"></i>
            </div>
            <div class="overview-content">
              <div class="overview-number">${formatNumber(totalAssists)}</div>
              <div class="overview-label">Total Assists</div>
              <div class="overview-avg">Avg: ${avgAssists}/year</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Yearly Breakdown -->
      <div class="yearly-section">
        <h4 class="section-title">
          <i class="bi bi-calendar-event text-primary"></i>
          Yearly Breakdown
        </h4>
        <div class="yearly-grid">
    `;

          // Sort by year (most recent first)
          const sortedData = [...yearlyData].sort((a, b) => b.year - a.year);

          sortedData.forEach((year, index) => {
            const totalContributions = year.goals + year.assists;
            const goalPercentage =
              totalContributions > 0
                ? ((year.goals / totalContributions) * 100).toFixed(1)
                : 0;
            const assistPercentage =
              totalContributions > 0
                ? ((year.assists / totalContributions) * 100).toFixed(1)
                : 0;

            // Add animation delay for staggered effect
            const animationDelay = index * 0.1;

            html += `
        <div class="yearly-card" style="animation-delay: ${animationDelay}s">
          <div class="yearly-header">
            <div class="year-badge">${year.year}</div>
            <div class="total-contributions">
              <span class="contributions-number">${formatNumber(
                totalContributions
              )}</span>
              <span class="contributions-label">Total</span>
            </div>
          </div>
          
          <div class="yearly-stats">
            <div class="stat-row goals-row">
              <div class="stat-info">
                <i class="bi bi-bullseye stat-icon"></i>
                <span class="stat-value">${formatNumber(year.goals)}</span>
                <span class="stat-label">Goals</span>
              </div>
              <div class="stat-progress">
                <div class="progress-bar">
                  <div class="progress-fill goals-fill" style="width: ${goalPercentage}%"></div>
                </div>
                <span class="progress-percentage">${goalPercentage}%</span>
              </div>
            </div>
            
            <div class="stat-row assists-row">
              <div class="stat-info">
                <i class="bi bi-hand-thumbs-up-fill stat-icon"></i>
                <span class="stat-value">${formatNumber(year.assists)}</span>
                <span class="stat-label">Assists</span>
              </div>
              <div class="stat-progress">
                <div class="progress-bar">
                  <div class="progress-fill assists-fill" style="width: ${assistPercentage}%"></div>
                </div>
                <span class="progress-percentage">${assistPercentage}%</span>
              </div>
            </div>
          </div>
          
          <div class="yearly-footer">
            <div class="performance-indicator ${getPerformanceClass(
              totalContributions,
              totalGoals / yearlyData.length + totalAssists / yearlyData.length
            )}">
              <i class="bi ${getPerformanceIcon(
                totalContributions,
                totalGoals / yearlyData.length +
                  totalAssists / yearlyData.length
              )}"></i>
              ${getPerformanceText(
                totalContributions,
                totalGoals / yearlyData.length +
                  totalAssists / yearlyData.length
              )}
            </div>
          </div>
        </div>
      `;
          });

          html += `
        </div>
      </div>
    `;

          container.innerHTML = html;

          // Add entrance animation
          setTimeout(() => {
            container.classList.add("loaded");
          }, 100);
        } catch (error) {
          showError("yearlyStatsContainer", "Failed to load yearly statistics");
          console.error(error);
        }
      }

      // Helper functions for performance indicators
      function getPerformanceClass(current, average) {
        if (current > average * 1.2) return "performance-excellent";
        if (current > average) return "performance-good";
        if (current > average * 0.8) return "performance-average";
        return "performance-below";
      }

      function getPerformanceIcon(current, average) {
        if (current > average * 1.2) return "bi-star-fill";
        if (current > average) return "bi-arrow-up-circle-fill";
        if (current > average * 0.8) return "bi-dash-circle-fill";
        return "bi-arrow-down-circle-fill";
      }

      function getPerformanceText(current, average) {
        if (current > average * 1.2) return "Exceptional";
        if (current > average) return "Above Average";
        if (current > average * 0.8) return "Average";
        return "Below Average";
      }

      // Load best performances
      async function loadBestPerformances() {
        try {
          const [seasonData, intData, yearlyData] = await Promise.all([
            fetchData("season_data"),
            fetchData("int_data"),
            fetchData("yearly_data"),
          ]);

          // Combine club and international data
          const combinedData = [...seasonData, ...intData];

          // Aggregate by season
          const seasonMap = {};

          combinedData.forEach((entry) => {
            const key = entry.season;

            if (!seasonMap[key]) {
              seasonMap[key] = {
                season: entry.season,
                goals: 0,
                apps: 0,
                ratingWeightedSum: 0,
                ratingAppCount: 0,
                teams: new Set(),
              };
            }

            seasonMap[key].goals += entry.goals || 0;
            seasonMap[key].apps += entry.apps || 0;

            if (entry.team) {
              seasonMap[key].teams.add(teamNameMap[entry.team]);
            }

            if (typeof entry.avgrating === "number" && entry.apps > 0) {
              seasonMap[key].ratingWeightedSum += entry.avgrating * entry.apps;
              seasonMap[key].ratingAppCount += entry.apps;
            }
          });

          const aggregatedSeasons = Object.values(seasonMap).map((s) => ({
            ...s,
            avgrating:
              s.ratingAppCount > 0 ? s.ratingWeightedSum / s.ratingAppCount : 0,
            team: Array.from(s.teams).join(" / ") || "N/A",
          }));

          // Best season by total goals
          const bestSeason = aggregatedSeasons.reduce((best, current) =>
            current.goals > best.goals ? current : best
          );

          // Best season by weighted average rating
          const highestRatedSeason = aggregatedSeasons.reduce((best, current) =>
            current.avgrating > best.avgrating ? current : best
          );

          // Best year by goals
          const bestYear = yearlyData.reduce((best, current) =>
            current.goals > best.goals ? current : best
          );

          document.getElementById("bestPerformances").innerHTML = `
        <div class="col-md-4">
          <div class="stat-card highlight-card">
            <h5><i class="bi bi-trophy-fill"></i>Best Season (Goals)</h5>
            <div class="text-center">
              <div class="stat-number" style="font-size: 2.5rem;">${
                bestSeason.goals
              }</div>
              <p class="mb-2">${bestSeason.season} - ${bestSeason.team}</p>
              <small>Total across club + international</small>
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="stat-card highlight-card">
            <h5><i class="bi bi-calendar-fill"></i>Best Year</h5>
            <div class="text-center">
              <div class="stat-number" style="font-size: 2.5rem;">${
                bestYear.goals
              }</div>
              <p class="mb-2">${bestYear.year}</p>
              <small>${bestYear.apps} appearances</small>
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="stat-card highlight-card">
            <h5><i class="bi bi-star-fill"></i>Highest Rated Season</h5>
            <div class="text-center">
              <div class="stat-number" style="font-size: 2.5rem;">${highestRatedSeason.avgrating.toFixed(
                2
              )}</div>
              <p class="mb-2">${highestRatedSeason.season} - ${
            highestRatedSeason.team
          }</p>
              <small>${highestRatedSeason.goals} goals in ${
            highestRatedSeason.apps
          } apps</small>
            </div>
          </div>
        </div>
      `;
        } catch (error) {
          showError("bestPerformances", "Failed to load best performances");
          console.error(error);
        }
      }

      // Load detailed season stats
      async function loadSeasonDetails() {
        try {
          const [seasonData, intData] = await Promise.all([
            fetchData("season_data"),
            fetchData("int_data"),
          ]);

          const combinedData = [...seasonData, ...intData];
          const container = document.getElementById("seasonDetailsContainer");

          // Professional, compact CSS styles
          const styles = `
      <style>
        .sd-container {
          padding: 1.5rem;
          background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
          min-height: 100vh;
          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
          color: #1e293b;
        }

        .sd-season-card {
          background: #ffffff;
          border-radius: 12px;
          margin-bottom: 1.5rem;
          box-shadow: 
            0 1px 3px rgba(0, 0, 0, 0.1),
            0 1px 2px rgba(0, 0, 0, 0.06);
          border: 1px solid #e2e8f0;
          transition: all 0.2s ease;
          overflow: hidden;
        }

        .sd-season-card:hover {
          box-shadow: 
            0 10px 25px rgba(0, 0, 0, 0.1),
            0 4px 6px rgba(0, 0, 0, 0.05);
          transform: translateY(-2px);
        }

        .sd-season-header {
          padding: 1.5rem;
          border-bottom: 1px solid #f1f5f9;
          background: linear-gradient(135deg, #f8fafc 0%, #ffffff 100%);
        }

        .sd-season-title {
          display: flex;
          align-items: center;
          justify-content: space-between;
          margin: 0 0 1rem 0;
          flex-wrap: wrap;
          gap: 1rem;
        }

        .sd-season-name {
          display: flex;
          align-items: center;
          gap: 0.75rem;
          font-size: 1.375rem;
          font-weight: 600;
          color: #0f172a;
          letter-spacing: -0.025em;
        }

        .sd-season-icon {
          width: 32px;
          height: 32px;
          background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
          border-radius: 8px;
          display: flex;
          align-items: center;
          justify-content: center;
          color: white;
          font-size: 0.875rem;
        }

        .sd-totals-compact {
          display: flex;
          gap: 1.5rem;
          flex-wrap: wrap;
        }

        .sd-total-item {
          display: flex;
          flex-direction: column;
          align-items: center;
          padding: 0.75rem 1rem;
          background: #f8fafc;
          border-radius: 8px;
          border: 1px solid #e2e8f0;
          min-width: 80px;
          transition: all 0.2s ease;
        }

        .sd-total-item:hover {
          background: #f1f5f9;
          transform: translateY(-1px);
        }

        .sd-total-number {
          font-size: 1.5rem;
          font-weight: 700;
          color: #3b82f6;
          line-height: 1;
          margin-bottom: 0.25rem;
        }

        .sd-total-label {
          font-size: 0.75rem;
          color: #64748b;
          font-weight: 500;
          text-transform: uppercase;
          letter-spacing: 0.05em;
        }

        .sd-competitions-section {
          padding: 1.5rem;
        }

        .sd-competitions-grid {
          display: grid;
          gap: 1rem;
        }

        .sd-competition-card {
          background: #fafafa;
          border-radius: 8px;
          padding: 1.25rem;
          border: 1px solid #f1f5f9;
          transition: all 0.2s ease;
          display: flex;
          align-items: center;
          justify-content: space-between;
          gap: 1rem;
          min-height: 80px;
        }

        .sd-competition-card:hover {
          background: #f8fafc;
          border-color: #e2e8f0;
          transform: translateX(4px);
        }

        .sd-competition-info {
          display: flex;
          align-items: center;
          gap: 1rem;
          flex: 1;
          min-width: 0;
        }

        .sd-competition-logo {
          width: 36px;
          height: 36px;
          border-radius: 6px;
          flex-shrink: 0;
        }

        .sd-competition-details {
          flex: 1;
          min-width: 0;
        }

        .sd-competition-name {
          font-size: 1rem;
          font-weight: 600;
          color: #0f172a;
          margin: 0 0 0.25rem 0;
          line-height: 1.2;
        }

        .sd-team-name {
          font-size: 0.875rem;
          color: #64748b;
          font-weight: 500;
          margin: 0;
        }

        .sd-stats-compact {
          display: flex;
          gap: 1rem;
          align-items: center;
          flex-shrink: 0;
        }

        .sd-stat-item {
          display: flex;
          flex-direction: column;
          align-items: center;
          min-width: 50px;
        }

        .sd-stat-value {
          font-size: 1.125rem;
          font-weight: 700;
          color: #0f172a;
          line-height: 1;
        }

        .sd-stat-label {
          font-size: 0.6875rem;
          color: #64748b;
          font-weight: 500;
          text-transform: uppercase;
          letter-spacing: 0.05em;
          margin-top: 0.125rem;
        }

        .sd-rating-badge {
          background: linear-gradient(135åº¦, #10b981 0%, #059669 100%);
          color: white;
          padding: 0.375rem 0.75rem;
          border-radius: 20px;
          font-size: 0.75rem;
          font-weight: 600;
          letter-spacing: 0.025em;
          box-shadow: 0 2px 4px rgba(16, 185, 129, 0.2);
        }

        .sd-no-data {
          background: #ffffff;
          border-radius: 12px;
          padding: 3rem 2rem;
          text-align: center;
          box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
          border: 1px solid #e2e8f0;
        }

        .sd-no-data-icon {
          font-size: 2.5rem;
          color: #cbd5e1;
          margin-bottom: 1rem;
        }

        .sd-no-data-text {
          font-size: 1.125rem;
          color: #64748b;
          font-weight: 500;
          margin: 0;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
          .sd-container {
            padding: 1rem;
          }

          .sd-season-header {
            padding: 1.25rem;
          }

          .sd-season-title {
            flex-direction: column;
            align-items: flex-start;
          }

          .sd-totals-compact {
            justify-content: space-between;
            width: 100%;
          }

          .sd-competitions-section {
            padding: 1.25rem;
          }

          .sd-competition-card {
            flex-direction: column;
            align-items: flex-start;
            gap: 1rem;
            min-height: auto;
          }

          .sd-competition-info {
            width: 100%;
          }

          .sd-stats-compact {
            justify-content: space-between;
            width: 100%;
          }
        }

        @media (max-width: 480px) {
          .sd-season-header {
            padding: 1rem;
          }

          .sd-season-name {
            font-size: 1.25rem;
          }

          .sd-totals-compact {
            grid-template-columns: repeat(2, 1fr);
            display: grid;
            gap: 0.75rem;
          }

          .sd-competitions-section {
            padding: 1rem;
          }

          .sd-competition-card {
            padding: 1rem;
          }

          .sd-stats-compact {
            gap: 0.75rem;
          }
        }

        /* Subtle animations */
        .sd-season-card {
          animation: sdFadeIn 0.4s ease forwards;
          opacity: 0;
        }

        .sd-season-card:nth-child(1) { animation-delay: 0.05s; }
        .sd-season-card:nth-child(2) { animation-delay: 0.1s; }
        .sd-season-card:nth-child(3) { animation-delay: 0.15s; }
        .sd-season-card:nth-child(4) { animation-delay: 0.2s; }

        @keyframes sdFadeIn {
          to {
            opacity: 1;
          }
        }
      </style>
    `;

          if (combinedData.length === 0) {
            container.innerHTML = `
        ${styles}
        <div class="sd-container">
          <div class="sd-no-data">
            <div class="sd-no-data-icon">ðŸ“Š</div>
            <p class="sd-no-data-text">No season data available</p>
          </div>
        </div>
      `;
            return;
          }

          // Group data by season
          const groupedBySeason = combinedData.reduce((acc, item) => {
            if (!acc[item.season]) {
              acc[item.season] = [];
            }
            acc[item.season].push(item);
            return acc;
          }, {});

          let html = styles + '<div class="sd-container">';

          // Process each season
          Object.keys(groupedBySeason).forEach((seasonName) => {
            const competitions = groupedBySeason[seasonName];

            // Calculate season totals
            const seasonTotals = competitions.reduce(
              (totals, comp) => {
                totals.apps += comp.apps || 0;
                totals.goals += comp.goals || 0;
                totals.assists += comp.assists || 0;
                totals.ratingSum += (comp.avgrating || 0) * (comp.apps || 0);
                totals.totalApps += comp.apps || 0;
                return totals;
              },
              { apps: 0, goals: 0, assists: 0, ratingSum: 0, totalApps: 0 }
            );

            // Weighted average rating
            const avgRating =
              seasonTotals.totalApps > 0
                ? seasonTotals.ratingSum / seasonTotals.totalApps
                : 0;

            html += `
        <div class="sd-season-card">
          <div class="sd-season-header">
            <div class="sd-season-title">
              <div class="sd-season-name">
                <div class="sd-season-icon">ðŸ“…</div>
                ${seasonName}
              </div>
              <div class="sd-totals-compact">
                <div class="sd-total-item">
                  <span class="sd-total-number">${seasonTotals.apps}</span>
                  <span class="sd-total-label">Apps</span>
                </div>
                <div class="sd-total-item">
                  <span class="sd-total-number">${seasonTotals.goals}</span>
                  <span class="sd-total-label">Goals</span>
                </div>
                <div class="sd-total-item">
                  <span class="sd-total-number">${seasonTotals.assists}</span>
                  <span class="sd-total-label">Assists</span>
                </div>
                <div class="sd-total-item">
                  <span class="sd-total-number">${
                    avgRating > 0 ? avgRating.toFixed(1) : "N/A"
                  }</span>
                  <span class="sd-total-label">Rating</span>
                </div>
              </div>
            </div>
          </div>
          <div class="sd-competitions-section">
            <div class="sd-competitions-grid">`;

            // Add competitions
            competitions.forEach((competition) => {
              const compName = getCompetitionNameById(competition.competition);
              const teamDisplayName =
                competition.team && teamNameMap[competition.team]
                  ? teamNameMap[competition.team]
                  : "Spain FA";

              html += `
          <div class="sd-competition-card">
            <div class="sd-competition-info">
              <img src="${
                trophyImageMap[competition.competition]
              }" class="sd-competition-logo" alt="${compName}">
              <div class="sd-competition-details">
                <div class="sd-competition-name">${compName}</div>
                <div class="sd-team-name">${teamDisplayName}</div>
              </div>
            </div>
            <div class="sd-stats-compact">
              <div class="sd-stat-item">
                <span class="sd-stat-value">${competition.apps || 0}</span>
                <span class="sd-stat-label">Apps</span>
              </div>
              <div class="sd-stat-item">
                <span class="sd-stat-value">${competition.goals || 0}</span>
                <span class="sd-stat-label">Goals</span>
              </div>
              <div class="sd-stat-item">
                <span class="sd-stat-value">${competition.assists || 0}</span>
                <span class="sd-stat-label">Assists</span>
              </div>
              ${
                competition.avgrating > 0
                  ? `<div class="sd-rating-badge" style="color: #fbbf24;">${competition.avgrating.toFixed(
                      1
                    )}</div>`
                  : ""
              }
            </div>
          </div>`;
            });

            html += `
            </div>
          </div>
        </div>`;
          });

          html += "</div>";
          container.innerHTML = html;
        } catch (error) {
          showError("seasonDetailsContainer", "Failed to load season details");
          console.error(error);
        }
      }

      // Load competition stats
      async function loadCompetitionStats() {
        try {
          const [seasonData, intData] = await Promise.all([
            fetchData("season_data"),
            fetchData("int_data"),
          ]);

          const allData = [...seasonData, ...intData];

          // Group by competition
          const competitionStats = {};

          allData.forEach((season) => {
            const comp =
              getCompetitionNameById(season.competition) ||
              "Unknown Competition";

            if (!competitionStats[comp]) {
              competitionStats[comp] = {
                apps: 0,
                goals: 0,
                assists: 0,
                ratings: [],
                seasons: 0,
                compo: season.competition,
              };
            }

            competitionStats[comp].apps += season.apps || 0;
            competitionStats[comp].goals += season.goals || 0;
            competitionStats[comp].assists += season.assists || 0;

            if (typeof season.avgrating === "number" && season.avgrating > 0) {
              competitionStats[comp].ratings.push(season.avgrating);
            }

            competitionStats[comp].seasons += 1;
          });

          // Convert to array and sort by G + A
          const sortedCompetitions = Object.entries(competitionStats)
            .map(([competition, stats]) => ({
              competition,
              ...stats,
              totalGA: stats.goals + stats.assists,
            }))
            .sort((a, b) => b.totalGA - a.totalGA);

          const container = document.getElementById(
            "competitionStatsContainer"
          );
          let html = "";

          sortedCompetitions.forEach((stats, index) => {
            const avgRating = calculateAverage(stats.ratings);
            const goalsPerGame =
              stats.apps > 0 ? (stats.goals / stats.apps).toFixed(2) : "0.00";
            const gaPerGame =
              stats.apps > 0 ? (stats.totalGA / stats.apps).toFixed(2) : "0.00";
            const assistsPerGame =
              stats.apps > 0 ? (stats.assists / stats.apps).toFixed(2) : "0.00";
            const cardId = `player-comp-${index}`;
            const isTopThree = index < 3;
            const rankClass = isTopThree ? `rank-${index + 1}` : "";
            console.log(stats.compo);
            html += `
        <div class="player-comp-card ${rankClass}" id="${cardId}">
          <div class="comp-background-pattern"></div>
          
          <div class="comp-header">
            <div class="comp-rank-section">
              ${
                isTopThree
                  ? `<div class="comp-rank-badge">${index + 1}</div>`
                  : ""
              }
              <div class="comp-title-area">
                <div><img src="${
                  trophyImageMap[stats.compo]
                }" style="width:40px; height:40px;"></img></div>
                <h3 class="comp-name">${stats.competition}</h3>
                <div class="comp-subtitle">${stats.seasons} season${
              stats.seasons !== 1 ? "s" : ""
            }</div>
              </div>
            </div>
            <div class="comp-main-stat">
              <div class="main-stat-value">${stats.totalGA}</div>
              <div class="main-stat-label">G+A</div>
            </div>
          </div>
          
          <div class="comp-stats-row">
            <div class="comp-stat-item">
              <div class="stat-value">${formatNumber(stats.apps)}</div>
              <div class="stat-label">Apps</div>
            </div>
            <div class="comp-stat-item">
              <div class="stat-value">${formatNumber(stats.goals)}</div>
              <div class="stat-label">Goals</div>
            </div>
            <div class="comp-stat-item">
              <div class="stat-value">${formatNumber(stats.assists)}</div>
              <div class="stat-label">Assists</div>
            </div>
            <div class="comp-stat-item">
              <div class="stat-value">${avgRating}</div>
              <div class="stat-label">Rating</div>
            </div>
          </div>
          
          <div class="comp-performance-bar">
            <div class="perf-metric">
              <span class="perf-label">Goals / Game</span>
              <span class="perf-value">${goalsPerGame}</span>
            </div>
            <div class="perf-metric">
              <span class="perf-label">Assists / Game</span>
              <span class="perf-value">${assistsPerGame}</span>
            </div>
            <div class="perf-metric">
              <span class="perf-label">G + A / Game</span>
              <span class="perf-value">${gaPerGame}</span>
            </div>
          </div>
        </div>
      `;
          });

          // Modern, clean styling
          const styles = `
      <style>
        .player-comp-card {
          background: #ffffff;
          border-radius: 20px;
          padding: 0;
          margin: 20px 0;
          box-shadow: 0 8px 32px rgba(0, 0, 0, 0.08);
          border: 1px solid rgba(255, 255, 255, 0.2);
          overflow: hidden;
          position: relative;
          transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        
        .player-comp-card:hover {
          transform: translateY(-8px);
          box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        }
        
        .comp-background-pattern {
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
          opacity: 0.03;
          pointer-events: none;
        }
        
        .rank-1 .comp-background-pattern {
          background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
          opacity: 0.08;
        }
        
        .rank-2 .comp-background-pattern {
          background: linear-gradient(135deg, #C0C0C0 0%, #808080 100%);
          opacity: 0.08;
        }
        
        .rank-3 .comp-background-pattern {
          background: linear-gradient(135deg, #CD7F32 0%, #8B4513 100%);
          opacity: 0.08;
        }
        
        .comp-header {
          display: flex;
          justify-content: space-between;
          align-items: flex-start;
          padding: 28px 28px 20px 28px;
          position: relative;
          z-index: 1;
        }
        
        .comp-rank-section {
          display: flex;
          align-items: center;
          gap: 16px;
        }
        
        .comp-rank-badge {
          width: 40px;
          height: 40px;
          border-radius: 50%;
          display: flex;
          align-items: center;
          justify-content: center;
          font-weight: 700;
          font-size: 18px;
          color: white;
          background: linear-gradient(135deg, #6c757d, #495057);
        }
        
        .rank-1 .comp-rank-badge {
          background: linear-gradient(135deg, #FFD700, #FFA500);
          color: #1a1a1a;
          box-shadow: 0 4px 20px rgba(255, 215, 0, 0.4);
        }
        
        .rank-2 .comp-rank-badge {
          background: linear-gradient(135deg, #C0C0C0, #A0A0A0);
          color: #1a1a1a;
          box-shadow: 0 4px 20px rgba(192, 192, 192, 0.4);
        }
        
        .rank-3 .comp-rank-badge {
          background: linear-gradient(135deg, #CD7F32, #8B4513);
          color: white;
          box-shadow: 0 4px 20px rgba(205, 127, 50, 0.4);
        }
        
        .comp-title-area {
          flex: 1;
        }
        
        .comp-name {
          font-size: 24px;
          font-weight: 700;
          color: #1a1a1a;
          margin: 0 0 4px 0;
          line-height: 1.2;
        }
        
        .comp-subtitle {
          font-size: 14px;
          color: #6c757d;
          font-weight: 500;
        }
        
        .comp-main-stat {
          text-align: center;
          background: linear-gradient(135deg, #667eea, #764ba2);
          color: white;
          padding: 16px 20px;
          border-radius: 16px;
          min-width: 80px;
        }
        
        .main-stat-value {
          font-size: 32px;
          font-weight: 800;
          line-height: 1;
          margin-bottom: 4px;
        }
        
        .main-stat-label {
          font-size: 12px;
          font-weight: 600;
          opacity: 0.9;
          letter-spacing: 0.5px;
        }
        
        .comp-stats-row {
          display: grid;
          grid-template-columns: repeat(4, 1fr);
          gap: 0;
          margin: 0 28px;
          background: #f8f9fa;
          border-radius: 16px;
          padding: 4px;
        }
        
        .comp-stat-item {
          text-align: center;
          padding: 20px 16px;
          transition: all 0.3s ease;
          border-radius: 12px;
        }
        
        .comp-stat-item:hover {
          background: white;
          transform: translateY(-2px);
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .comp-stat-item.highlight {
          background: rgba(102, 126, 234, 0.05);
        }
        
        .comp-stat-item.highlight:hover {
          background: rgba(102, 126, 234, 0.1);
        }
        
        .stat-value {
          font-size: 24px;
          font-weight: 700;
          color: #1a1a1a;
          line-height: 1.2;
          margin-bottom: 4px;
        }
        
        .stat-label {
          font-size: 12px;
          color: #6c757d;
          font-weight: 600;
          text-transform: uppercase;
          letter-spacing: 0.5px;
        }
        
        .comp-performance-bar {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin: 20px 28px 28px 28px;
          padding: 16px 20px;
          background: linear-gradient(90deg, rgba(102, 126, 234, 0.05), rgba(118, 75, 162, 0.05));
          border-radius: 12px;
          border: 1px solid rgba(102, 126, 234, 0.1);
        }
        
        .perf-metric {
          display: flex;
          align-items: center;
          gap: 8px;
        }
        
        .perf-label {
          font-size: 13px;
          color: #6c757d;
          font-weight: 600;
        }
        
        .perf-value {
          font-size: 16px;
          font-weight: 700;
          color: #667eea;
          background: rgba(102, 126, 234, 0.1);
          padding: 4px 8px;
          border-radius: 6px;
        }
        
        .player-comp-no-data {
          text-align: center;
          padding: 60px 20px;
          background: #ffffff;
          border-radius: 20px;
          box-shadow: 0 8px 32px rgba(0, 0, 0, 0.08);
          color: #6c757d;
        }
        
        .player-comp-no-data::before {
          content: "ðŸ“Š";
          font-size: 48px;
          display: block;
          margin-bottom: 16px;
        }
        
        @media (max-width: 768px) {
          .comp-header {
            flex-direction: column;
            gap: 20px;
            align-items: flex-start;
          }
          
          .comp-main-stat {
            align-self: flex-end;
          }
          
          .comp-stats-row {
            grid-template-columns: repeat(2, 1fr);
            margin: 0 20px;
          }
          
          .comp-name {
            font-size: 20px;
          }
          
          .comp-performance-bar {
            flex-direction: column;
            gap: 12px;
            margin: 20px 20px 20px 20px;
          }
        }
        
        @media (max-width: 480px) {
          .player-comp-card {
            margin: 16px 0;
          }
          
          .comp-header {
            padding: 20px 20px 16px 20px;
          }
          
          .comp-rank-section {
            gap: 12px;
          }
          
          .comp-rank-badge {
            width: 32px;
            height: 32px;
            font-size: 16px;
          }
          
          .comp-name {
            font-size: 18px;
          }
        }
      </style>
    `;

          container.innerHTML =
            styles +
            (html ||
              '<div class="player-comp-no-data">No competition data available</div>');
        } catch (error) {
          showError(
            "competitionStatsContainer",
            "Failed to load competition statistics"
          );
          console.error(error);
        }
      }

      // Load team stats
      async function loadTeamStats() {
        try {
          const seasonData = await fetchData("season_data");

          // Group by team and competition
          const teamStats = {};
          seasonData.forEach((season) => {
            if (!teamStats[season.team]) {
              teamStats[season.team] = {
                overall: {
                  apps: 0,
                  goals: 0,
                  assists: 0,
                  ratings: [],
                  seasonsSet: new Set(),
                  competitions: new Set(),
                },
                competitions: {},
              };
            }

            const competitionName = getCompetitionNameById(season.competition);

            // Initialize competition stats if not exists
            if (!teamStats[season.team].competitions[competitionName]) {
              teamStats[season.team].competitions[competitionName] = {
                apps: 0,
                goals: 0,
                assists: 0,
                ratings: [],
                seasonsSet: new Set(),
              };
            }

            // Update overall stats
            teamStats[season.team].overall.apps += season.apps || 0;
            teamStats[season.team].overall.goals += season.goals || 0;
            teamStats[season.team].overall.assists += season.assists || 0;

            if (season.avgrating > 0) {
              teamStats[season.team].overall.ratings.push(season.avgrating);
            }

            if (season.season) {
              teamStats[season.team].overall.seasonsSet.add(season.season);
            }

            teamStats[season.team].overall.competitions.add(competitionName);

            // Update competition-specific stats
            const compStats =
              teamStats[season.team].competitions[competitionName];
            compStats.apps += season.apps || 0;
            compStats.goals += season.goals || 0;
            compStats.assists += season.assists || 0;

            if (season.avgrating > 0) {
              compStats.ratings.push(season.avgrating);
            }

            if (season.season) {
              compStats.seasonsSet.add(season.season);
            }
          });

          const container = document.getElementById("teamStatsContainer");

          // Enhanced CSS styles with competition breakdown
          const styles = `
      <style>
        .ts-stats-container {
          display: flex;
          flex-direction: column;
          gap: 2rem;
          padding: 2rem;
          background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
          min-height: 100vh;
          font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .ts-team-card {
          background: rgba(255, 255, 255, 0.95);
          backdrop-filter: blur(20px);
          border-radius: 24px;
          padding: 2rem;
          box-shadow: 
            0 20px 40px rgba(0, 0, 0, 0.1),
            0 8px 16px rgba(0, 0, 0, 0.06),
            inset 0 1px 0 rgba(255, 255, 255, 0.8);
          border: 1px solid rgba(255, 255, 255, 0.2);
          transition: all 0.4s cubic-bezier(0.165, 0.84, 0.44, 1);
          position: relative;
          overflow: hidden;
          width: 100%;
        }

        .ts-team-card::before {
          content: '';
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          height: 4px;
          background: linear-gradient(90deg, #ff6b6b, #4ecdc4, #45b7d1, #96ceb4, #ffeaa7);
          background-size: 400% 400%;
          animation: tsGradientShift 8s ease infinite;
        }

        @keyframes tsGradientShift {
          0%, 100% { background-position: 0% 50%; }
          50% { background-position: 100% 50%; }
        }

        .ts-team-card:hover {
          transform: translateY(-12px) scale(1.02);
          box-shadow: 
            0 32px 64px rgba(0, 0, 0, 0.15),
            0 16px 32px rgba(0, 0, 0, 0.1),
            inset 0 1px 0 rgba(255, 255, 255, 0.9);
        }

        .ts-team-header {
          display: flex;
          align-items: center;
          gap: 1.5rem;
          margin-bottom: 2rem;
          padding-bottom: 1.5rem;
          border-bottom: 2px solid rgba(102, 126, 234, 0.1);
          position: relative;
        }

        .ts-team-logo {
          width: 90px;
          height: 90px;
          border-radius: 20px;
          object-fit: cover;
          box-shadow: 
            0 12px 24px rgba(0, 0, 0, 0.15),
            0 4px 8px rgba(0, 0, 0, 0.1);
          transition: all 0.3s ease;
          border: 3px solid rgba(255, 255, 255, 0.8);
        }

        .ts-team-card:hover .ts-team-logo {
          transform: rotate(5deg) scale(1.1);
          box-shadow: 
            0 16px 32px rgba(0, 0, 0, 0.2),
            0 8px 16px rgba(0, 0, 0, 0.15);
        }

        .ts-team-name {
          font-size: 1.8rem;
          font-weight: 700;
          color: #2d3436;
          margin: 0;
          text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
          letter-spacing: -0.5px;
        }

        .ts-section-title {
          font-size: 1.3rem;
          font-weight: 700;
          color: #2d3436;
          margin: 2rem 0 1rem 0;
          text-transform: uppercase;
          letter-spacing: 1px;
          position: relative;
          display: flex;
          align-items: center;
          gap: 1rem;
        }

        .ts-section-title::after {
          content: '';
          flex: 1;
          height: 2px;
          background: linear-gradient(90deg, #667eea, transparent);
        }

        .ts-stat-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
          gap: 1.5rem;
          margin-bottom: 2rem;
        }

        .ts-stat-item {
          background: linear-gradient(135deg, #f8f9ff 0%, #e8ecff 100%);
          border-radius: 16px;
          padding: 1.5rem;
          text-align: center;
          transition: all 0.3s ease;
          border: 1px solid rgba(102, 126, 234, 0.1);
          position: relative;
          overflow: hidden;
        }

        .ts-stat-item::before {
          content: '';
          position: absolute;
          top: 0;
          left: -100%;
          width: 100%;
          height: 100%;
          background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
          transition: left 0.5s;
        }

        .ts-team-card:hover .ts-stat-item::before {
          left: 100%;
        }

        .ts-stat-item:hover {
          transform: translateY(-4px);
          box-shadow: 0 12px 24px rgba(102, 126, 234, 0.15);
          background: linear-gradient(135deg, #fff 0%, #f0f4ff 100%);
        }

        .ts-stat-number {
          display: block;
          font-size: 2.2rem;
          font-weight: 800;
          color: #667eea;
          margin-bottom: 0.5rem;
          text-shadow: 0 2px 4px rgba(102, 126, 234, 0.2);
        }

        .ts-stat-label {
          font-size: 0.9rem;
          color: #636e72;
          font-weight: 600;
          text-transform: uppercase;
          letter-spacing: 0.5px;
        }

        .ts-competition-section {
          margin-top: 2rem;
          padding-top: 2rem;
          border-top: 2px solid rgba(102, 126, 234, 0.1);
        }

        .ts-competition-card {
          background: linear-gradient(135deg, #6c5ce7 0%, #a29bfe 100%);
          border-radius: 20px;
          padding: 2rem;
          margin-bottom: 2rem;
          position: relative;
          overflow: hidden;
          box-shadow: 0 12px 24px rgba(108, 92, 231, 0.2);
          transition: all 0.3s ease;
        }

        .ts-competition-card::before {
          content: '';
          position: absolute;
          top: -50%;
          left: -50%;
          width: 200%;
          height: 200%;
          background: radial-gradient(circle, rgba(255, 255, 255, 0.1) 0%, transparent 70%);
          animation: tsRotate 20s linear infinite;
        }

        @keyframes tsRotate {
          from { transform: rotate(0deg); }
          to { transform: rotate(360deg); }
        }

        .ts-competition-card:hover {
          transform: translateY(-8px);
          box-shadow: 0 20px 40px rgba(108, 92, 231, 0.3);
        }

        .ts-competition-title {
          font-size: 1.4rem;
          font-weight: 700;
          color: #fff;
          margin-bottom: 1.5rem;
          text-transform: uppercase;
          letter-spacing: 1px;
          position: relative;
          z-index: 1;
          text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .ts-competition-stats {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
          gap: 1rem;
          position: relative;
          z-index: 1;
        }

        .ts-competition-stat {
          background: rgba(255, 255, 255, 0.15);
          backdrop-filter: blur(10px);
          border-radius: 12px;
          padding: 1rem;
          text-align: center;
          transition: all 0.3s ease;
          border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .ts-competition-stat:hover {
          background: rgba(255, 255, 255, 0.25);
          transform: translateY(-2px);
        }

        .ts-competition-stat-number {
          display: block;
          font-size: 1.8rem;
          font-weight: 800;
          color: #fff;
          margin-bottom: 0.3rem;
          text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .ts-competition-stat-label {
          font-size: 0.8rem;
          color: rgba(255, 255, 255, 0.9);
          font-weight: 600;
          text-transform: uppercase;
          letter-spacing: 0.5px;
        }

        .ts-no-data-card {
          background: rgba(255, 255, 255, 0.95);
          backdrop-filter: blur(20px);
          border-radius: 24px;
          padding: 4rem 2rem;
          text-align: center;
          box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
          border: 1px solid rgba(255, 255, 255, 0.2);
          width: 100%;
        }

        .ts-no-data-text {
          font-size: 1.2rem;
          color: #636e72;
          font-weight: 600;
          margin: 0;
        }

        .ts-loading-shimmer {
          background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
          background-size: 200% 100%;
          animation: tsShimmer 2s infinite;
        }

        @keyframes tsShimmer {
          0% { background-position: -200% 0; }
          100% { background-position: 200% 0; }
        }

        /* Responsive Design */
        @media (max-width: 768px) {
          .ts-stats-container {
            gap: 1.5rem;
            padding: 1rem;
          }
          
          .ts-team-card {
            padding: 1.5rem;
          }
          
          .ts-team-header {
            flex-direction: column;
            text-align: center;
            gap: 1rem;
          }
          
          .ts-team-logo {
            width: 80px;
            height: 80px;
          }
          
          .ts-team-name {
            font-size: 1.5rem;
          }
          
          .ts-stat-grid {
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 1rem;
          }
          
          .ts-stat-number {
            font-size: 1.8rem;
          }

          .ts-competition-stats {
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
          }

          .ts-competition-stat-number {
            font-size: 1.5rem;
          }
        }

        @media (max-width: 480px) {
          .ts-team-card {
            padding: 1rem;
          }
          
          .ts-team-logo {
            width: 60px;
            height: 60px;
          }
          
          .ts-team-name {
            font-size: 1.3rem;
          }
          
          .ts-stat-grid {
            grid-template-columns: repeat(2, 1fr);
          }

          .ts-competition-stats {
            grid-template-columns: repeat(2, 1fr);
          }
        }
      </style>
    `;

          // Apply the container class to the existing element
          container.className = "ts-stats-container";

          let html = styles;

          Object.entries(teamStats).forEach(([team, stats]) => {
            const overallStats = stats.overall;
            const avgRating = calculateAverage(overallStats.ratings);
            const seasonCount = overallStats.seasonsSet.size;
            const goalsPerGame =
              overallStats.apps > 0
                ? (overallStats.goals / overallStats.apps).toFixed(2)
                : "0.00";

            html += `
        <div class="ts-team-card">
          <div class="ts-team-header">
            <img src="${teamImageMap[team]}" alt="${
              teamNameMap[team]
            } logo" class="ts-team-logo">
            <h3 class="ts-team-name">${teamNameMap[team]}</h3>
          </div>
          
          <div class="ts-section-title">Overall Statistics</div>
          <div class="ts-stat-grid">
            <div class="ts-stat-item">
              <span class="ts-stat-number">${seasonCount}</span>
              <span class="ts-stat-label">Seasons</span>
            </div>
            <div class="ts-stat-item">
              <span class="ts-stat-number">${formatNumber(
                overallStats.apps
              )}</span>
              <span class="ts-stat-label">Appearances</span>
            </div>
            <div class="ts-stat-item">
              <span class="ts-stat-number">${formatNumber(
                overallStats.goals
              )}</span>
              <span class="ts-stat-label">Goals</span>
            </div>
            <div class="ts-stat-item">
              <span class="ts-stat-number">${formatNumber(
                overallStats.assists
              )}</span>
              <span class="ts-stat-label">Assists</span>
            </div>
            <div class="ts-stat-item">
              <span class="ts-stat-number">${avgRating}</span>
              <span class="ts-stat-label">Avg Rating</span>
            </div>
            <div class="ts-stat-item">
              <span class="ts-stat-number">${goalsPerGame}</span>
              <span class="ts-stat-label">Goals per Game</span>
            </div>
          </div>
          
          <div class="ts-competition-section">
            <div class="ts-section-title">Competition Breakdown</div>
            ${Object.entries(stats.competitions)
              .map(([competition, compStats]) => {
                const compAvgRating = calculateAverage(compStats.ratings);
                const compGoalsPerGame =
                  compStats.apps > 0
                    ? (compStats.goals / compStats.apps).toFixed(2)
                    : "0.00";
                const compSeasonCount = compStats.seasonsSet.size;
                console.log(competition);

                return `
              
                <div class="sd-competition-card">
            <div class="sd-competition-info">
              <img src="${
                trophyImageMap[getCompetitionIdByName(competition)]
              }" class="sd-competition-logo" alt="${competition}">
              <div class="sd-competition-details">
                <div class="sd-competition-name">${competition}</div>
              </div>
            </div>
            <div class="sd-stats-compact">
              <div class="sd-stat-item">
                <span class="sd-stat-value">${compSeasonCount || 0}</span>
                <span class="sd-stat-label">Seasons</span>
              </div>
              <div class="sd-stat-item">
                <span class="sd-stat-value">${
                  formatNumber(compStats.apps) || 0
                }</span>
                <span class="sd-stat-label">Apps</span>
              </div>
              <div class="sd-stat-item">
                <span class="sd-stat-value">${
                  formatNumber(compStats.goals) || 0
                }</span>
                <span class="sd-stat-label">Goals</span>
              </div>
              <div class="sd-stat-item">
                <span class="sd-stat-value">${
                  formatNumber(compStats.assists) || 0
                }</span>
                <span class="sd-stat-label">Assists</span>
              </div>
              ${
                compAvgRating > 0
                  ? `<div class="sd-rating-badge" style="color: #fbbf24;">${compAvgRating}</div>`
                  : ""
              }
            </div>
          </div>
                `;
              })
              .join("")}
          </div>
        </div>
      `;
          });

          container.innerHTML =
            html ||
            `
      ${styles}
      <div class="ts-no-data-card">
        <p class="ts-no-data-text">No team data available</p>
      </div>
    `;
        } catch (error) {
          showError("teamStatsContainer", "Failed to load team statistics");
          console.error(error);
        }
      }

      // Initialize the page
      async function init() {
        try {
          await Promise.all([
            loadCareerTotals(),
            loadClubStats(),
            loadIntStats(),
            loadYearlyStats(),
            loadBestPerformances(),
            loadSeasonDetails(),
            loadCompetitionStats(),
            loadTeamStats(),
          ]);
        } catch (error) {
          console.error("Error initializing dashboard:", error);
        }
      }

      // Load data when page loads
      document.addEventListener("DOMContentLoaded", init);
    </script>
  </body>
</html>
